<script type="text/javascript">
		var gk_isXlsx = false;
		var gk_xlsxFileLookup = {};
		var gk_fileData = {};
		function filledCell(cell) {
		  return cell !== '' && cell != null;
		}
		function loadFileData(filename) {
		if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
			try {
				var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
				var firstSheetName = workbook.SheetNames[0];
				var worksheet = workbook.Sheets[firstSheetName];

				// Convert sheet to JSON to filter blank rows
				var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
				// Filter out blank rows (rows where all cells are empty, null, or undefined)
				var filteredData = jsonData.filter(row => row.some(filledCell));

				// Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
				var headerRowIndex = filteredData.findIndex((row, index) =>
				  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
				);
				// Fallback
				if (headerRowIndex === -1 || headerRowIndex > 25) {
				  headerRowIndex = 0;
				}

				// Convert filtered JSON back to CSV
				var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
				csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
				return csv;
			} catch (e) {
				console.error(e);
				return "";
			}
		}
		return gk_fileData[filename] || "";
		}
		</script><!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Gen Z Texter Bot</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<style>
		body { background-color: #f0f2f5; font-family: 'Segoe UI', sans-serif; }
		.chat-container { max-width: 600px; margin: auto; height: 100vh; display: flex; flex-direction: column; }
		.chat-header { background-color: #00a884; color: white; padding: 10px; text-align: center; }
		.chat-messages { flex-grow: 1; overflow-y: auto; padding: 20px; background-image: url('https://i.imgur.com/5qx5g7q.png'); }
		.message { margin: 10px; padding: 10px 15px; border-radius: 10px; max-width: 70%; }
		.user-message { background-color: #d9fdd3; align-self: flex-end; }
		.bot-message { background-color: white; align-self: flex-start; }
		.input-container { background-color: white; padding: 10px; display: flex; }
		#message-input { flex-grow: 1; padding: 10px; border: none; border-radius: 20px; background-color: #f0f2f5; }
		#send-button { background-color: #00a884; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; margin-left: 10px; }
	</style>
</head>
<body>
	<div class="chat-container">
		<div class="chat-header">
			<h1 class="text-xl font-bold">Gen Z Texter Bot</h1>
		</div>
		<div class="chat-messages" id="chat-messages"></div>
		<div class="input-container">
			<input type="text" id="message-input" placeholder="Type a message..." />
			<button id="send-button">âž¤</button>
		</div>
	</div>
	<script>
		const chatMessages = document.getElementById('chat-messages');
		const messageInput = document.getElementById('message-input');
		const sendButton = document.getElementById('send-button');

		function addMessage(text, isUser) {
			const messageDiv = document.createElement('div');
			messageDiv.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
			messageDiv.innerHTML = text;
			chatMessages.appendChild(messageDiv);
			chatMessages.scrollTop = chatMessages.scrollHeight;
		}

		async function sendMessage() {
			const message = messageInput.value.trim();
			if (!message) return;
			addMessage(message, true);
			messageInput.value = '';

			try {
				const response = await fetch('/chat', {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify({ message })
				});
				const data = await response.json();
				addMessage(data.response, false);
			} catch (error) {
				addMessage('Oops, something broke. Try again? ðŸ˜…', false);
			}
		}

		sendButton.addEventListener('click', sendMessage);
		messageInput.addEventListener('keypress', (e) => {
			if (e.key === 'Enter') sendMessage();
		});
	</script>
</body>
</html>
